#ifndef LOLECTOOLS_WINDOWSGAMEPAD_HQT
#define LOLECTOOLS_WINDOWSGAMEPAD_HQT

#include "Gamepad.h"

#define DIRECTINPUT_VERSION 0x0800

#include <dinput.h>
#include <QMap>

class WindowsGamepadFactory;
class WindowsGamepad : public Gamepad
{
public:
    virtual int getResolution() const;
    virtual ~WindowsGamepad();
protected:
    WindowsGamepad(const QString& name);
    virtual void run();
    virtual bool initialize();
    virtual QString getName() { return mName; }

    virtual void update(QMap<int, double>& joysticks, QMap<int, bool>& buttons);
    float correctedValue(float v);

    static BOOL CALLBACK enumObject(const DIDEVICEOBJECTINSTANCE* pdidoi, VOID* pContext);

    LPDIRECTINPUTDEVICE8 mDevice;
    DIJOYSTATE2 mState;
    friend class WindowsGamepadFactory;
    QString mName;
};

#endif //LOLECTOOLS_WINDOWSGAMEPAD_HQT
